<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: drv_can.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">drv_can.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Code for CAN driver in STM32F4 using STM32Cube_FW_F4_V1.24.0.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="drv__can_8h_source.html">drv_can.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ace7de72cc97ae2a35d63c3a4a4772a31"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="drv__can_8c.html#ace7de72cc97ae2a35d63c3a4a4772a31">CAN_init</a> (void)</td></tr>
<tr class="memdesc:ace7de72cc97ae2a35d63c3a4a4772a31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize CAN Bus.  <a href="#ace7de72cc97ae2a35d63c3a4a4772a31">More...</a><br /></td></tr>
<tr class="separator:ace7de72cc97ae2a35d63c3a4a4772a31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c92d47f2312d59bfef132e05c364d89"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="drv__can_8c.html#a0c92d47f2312d59bfef132e05c364d89">CAN_rx_callback_register</a> (CAN_HandleTypeDef *hcan, void(*pFunc)(<a class="el" href="struct_c_a_n___rx_message.html">CAN_RxBuffer</a> *))</td></tr>
<tr class="memdesc:a0c92d47f2312d59bfef132e05c364d89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registered user callback function.  <a href="#a0c92d47f2312d59bfef132e05c364d89">More...</a><br /></td></tr>
<tr class="separator:a0c92d47f2312d59bfef132e05c364d89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad990eb8d3a6ec54cbbb21ef604c403c3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="drv__can_8c.html#ad990eb8d3a6ec54cbbb21ef604c403c3">CAN_Filter_Mask_Config</a> (CAN_HandleTypeDef *_hcan, uint8_t object_para, uint32_t Id, uint32_t MaskId)</td></tr>
<tr class="memdesc:ad990eb8d3a6ec54cbbb21ef604c403c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Can_Filter_Mask_Config 配置CAN的筛选器  <a href="#ad990eb8d3a6ec54cbbb21ef604c403c3">More...</a><br /></td></tr>
<tr class="separator:ad990eb8d3a6ec54cbbb21ef604c403c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79e8d950603d5f5d61ce82dc6cc03fe1"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="drv__can_8c.html#a79e8d950603d5f5d61ce82dc6cc03fe1">CANx_SendData</a> (CAN_HandleTypeDef *hcan, uint16_t ID, uint8_t *pData, uint16_t Len)</td></tr>
<tr class="memdesc:a79e8d950603d5f5d61ce82dc6cc03fe1"><td class="mdescLeft">&#160;</td><td class="mdescRight">通过CAN发送消息(数据帧)  <a href="#a79e8d950603d5f5d61ce82dc6cc03fe1">More...</a><br /></td></tr>
<tr class="separator:a79e8d950603d5f5d61ce82dc6cc03fe1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7368d39e78009c017d6f81ccf33b9b2c"><td class="memItemLeft" align="right" valign="top"><a id="a7368d39e78009c017d6f81ccf33b9b2c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>HAL_CAN_RxFifo0MsgPendingCallback</b> (CAN_HandleTypeDef *hcan)</td></tr>
<tr class="separator:a7368d39e78009c017d6f81ccf33b9b2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6dd58034ec0e0a887b1c36317c4c64b"><td class="memItemLeft" align="right" valign="top"><a id="af6dd58034ec0e0a887b1c36317c4c64b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>HAL_CAN_RxFifo1MsgPendingCallback</b> (CAN_HandleTypeDef *hcan)</td></tr>
<tr class="separator:af6dd58034ec0e0a887b1c36317c4c64b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Code for CAN driver in STM32F4 using STM32Cube_FW_F4_V1.24.0. </p>
<p>Copyright (c) 2019 - ~, SCUT-RobotLab Development Team</p>
<dl class="section author"><dt>Author</dt><dd>Mentos_Seetoo <a href="#" onclick="location.href='mai'+'lto:'+'135'+'60'+'469'+'79'+'@qq'+'.c'+'om'; return false;">13560<span style="display: none;">.nosp@m.</span>4697<span style="display: none;">.nosp@m.</span>9@qq.<span style="display: none;">.nosp@m.</span>com</a> </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2019-06-12 </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 </dd></dl>
<dl class="section user"><dt>Change Log：</dt><dd><table class="doxtable">
<tr>
<th>Date </th><th>Version </th><th>Author </th><th>Description </th></tr>
<tr>
<td>2019-06-12 </td><td>1.0 </td><td>Mentos Seetoo </td><td>Creator </td></tr>
</table>
<hr/>
 <h1>##### How to use this driver ##### </h1>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ol type="1">
<li>把要用的CAN宏定义置1，其余置0:<br />
 CAN1_ON_BOARD, CAN2_ON_BOARD</li>
<li>调用CAN_Init()，初始化CAN。</li>
<li>调用CAN_rx_callback_register 设置CAN接收处理函数的指针。</li>
<li>在需要用到发送的部分直接调用CANx_SendData()函数。</li>
</ol>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ol type="1">
<li>本模块只能保存一条来自于同一个FIFO的消息(详细见下方HAL库FIFOx中断的 实现),请注意及时读走消息。</li>
<li>由于本模块运行基于STM32CubeMX生成的代码，所以头文件extern部分常用固定的结构体 名称,也方便其他地方调用。</li>
</ol>
</dd></dl>
<dl class="section attention"><dt>Attention</dt><dd></dd></dl>
<p>if you had modified this file, please make sure your code does not have many bugs, update the version Number, write dowm your name and the date, the most important is make sure the users will have clear and definite understanding through your new brief.</p>
<h2><center>&copy; Copyright (c) 2019 - ~, SCUT-RobotLab Development Team. All rights reserved.</center></h2>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ad990eb8d3a6ec54cbbb21ef604c403c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad990eb8d3a6ec54cbbb21ef604c403c3">&#9670;&nbsp;</a></span>CAN_Filter_Mask_Config()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CAN_Filter_Mask_Config </td>
          <td>(</td>
          <td class="paramtype">CAN_HandleTypeDef *&#160;</td>
          <td class="paramname"><em>_hcan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>object_para</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>Id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>MaskId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Can_Filter_Mask_Config 配置CAN的筛选器 </p>
<p>筛选器:|编号|FIFOx|ID类型|帧类型|ID|屏蔽位(0x3ff,0x1FFFFFFF)| <br />
 老队长留下来的遗产，望各位珍惜hhh. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">object_para</td><td>|编号|FIFOx|ID类型|帧类型|ID| </td></tr>
    <tr><td class="paramname">Id</td><td>ID </td></tr>
    <tr><td class="paramname">MaskId</td><td>屏蔽位(0x3ff,0x1FFFFFFF) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ace7de72cc97ae2a35d63c3a4a4772a31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace7de72cc97ae2a35d63c3a4a4772a31">&#9670;&nbsp;</a></span>CAN_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CAN_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize CAN Bus. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0c92d47f2312d59bfef132e05c364d89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c92d47f2312d59bfef132e05c364d89">&#9670;&nbsp;</a></span>CAN_rx_callback_register()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t CAN_rx_callback_register </td>
          <td>(</td>
          <td class="paramtype">CAN_HandleTypeDef *&#160;</td>
          <td class="paramname"><em>hcan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(<a class="el" href="struct_c_a_n___rx_message.html">CAN_RxBuffer</a> *)&#160;</td>
          <td class="paramname"><em>pFunc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registered user callback function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hcan</td><td>CANx created by CubeMX. </td></tr>
    <tr><td class="paramname">pFunc</td><td>user callback function </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">SUCCESS/ERROR</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a79e8d950603d5f5d61ce82dc6cc03fe1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79e8d950603d5f5d61ce82dc6cc03fe1">&#9670;&nbsp;</a></span>CANx_SendData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t CANx_SendData </td>
          <td>(</td>
          <td class="paramtype">CAN_HandleTypeDef *&#160;</td>
          <td class="paramname"><em>hcan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>Len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>通过CAN发送消息(数据帧) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hcan</td><td>:使用的CAN线 </td></tr>
    <tr><td class="paramname">ID</td><td>:发送者ID </td></tr>
    <tr><td class="paramname">*pData</td><td>:发送的数据 </td></tr>
    <tr><td class="paramname">Len</td><td>:数据长度 </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">CAN_SUCCESS</td><td>:发送成功 </td></tr>
    <tr><td class="paramname">CAN_LINE_BUSY</td><td>:发送失败 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Mentos </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
